<sub-article article-type="notebook" id="nb-11">
<front-stub>
</front-stub>

<body>
<p>Here is we install/load all the packages we use in this project.</p>
<sec specific-use="notebook-content">
<code language="r script">
## create vector of packages used
pkg &lt;- c(&quot;helpers&quot; = c(&quot;stringr&quot;, &quot;DT&quot;, &quot;reshape&quot;, &quot;dplyr&quot;, &quot;tidyr&quot;,
                       &quot;tibble&quot;, &quot;purrr&quot;, &quot;here&quot;, &quot;readr&quot;, &quot;kableExtra&quot;, 
                       &quot;janitor&quot;, &quot;labelled&quot;, &quot;BiocManager&quot;, &quot;data.table&quot;,
                       &quot;gt&quot;, &quot;europepmc&quot;, &quot;readxl&quot;, &quot;NMF&quot;, &quot;furrr&quot;,
                       &quot;future.apply&quot;, &quot;parallel&quot;, &quot;targets&quot;, &quot;forcats&quot;),
         &quot;website&quot; = c(&quot;downlit&quot;, &quot;xml2&quot;),
         &quot;plots&quot; = c(&quot;corrgram&quot;, &quot;RColorBrewer&quot;, &quot;pheatmap&quot;, &quot;ggplot2&quot;,
                     &quot;ggsci&quot;, &quot;cowplot&quot;, &quot;scales&quot;, &quot;ggvenn&quot;, &quot;ggpubr&quot;, 
                     &quot;gridExtra&quot;, &quot;tidytext&quot;, &quot;viridis&quot;, &quot;wesanderson&quot;,
                     &quot;pals&quot;, &quot;ggalluvial&quot;))

pkg_bioconductor &lt;- c(&quot;cellity&quot;, &quot;scater&quot;, &quot;Seurat&quot;, &quot;SC3&quot;, &quot;DESeq2&quot;, &quot;edgeR&quot;,
                      &quot;BiocParallel&quot;, &quot;org.Hs.eg.db&quot;, &quot;pathview&quot;, &quot;gage&quot;,
                      &quot;gageData&quot;, &quot;DropletUtils&quot;, &quot;ensembldb&quot;, 
                      &quot;AnnotationHub&quot;, &quot;patchwork&quot;, &quot;scran&quot;, &quot;scuttle&quot;,  
                      &quot;PCAtools&quot;, &quot;batchelor&quot;, &quot;bluster&quot;, &quot;igraph&quot;, 
                      &quot;SingleCellExperiment&quot;, &quot;scRNAseq&quot;, &quot;biomaRt&quot;,
                      &quot;GEOquery&quot;, &quot;AnnotationDbi&quot;, &quot;clusterProfiler&quot;,
                      &quot;DOSE&quot;, &quot;enrichplot&quot;, &quot;EnsDb.Hsapiens.v79&quot;, &quot;fgsea&quot;,
                      &quot;MAST&quot;, &quot;speckle&quot;, &quot;rrvgo&quot;, &quot;MungeSumstats&quot;,
                      &quot;BSgenome.Hsapiens.1000genomes.hs37d5&quot;,
                      &quot;BSgenome.Hsapiens.NCBI.GRCh38&quot;,
                      &quot;SNPlocs.Hsapiens.dbSNP155.GRCh37&quot;, &quot;qusage&quot;,
                      &quot;SNPlocs.Hsapiens.dbSNP155.GRCh38&quot;,
                      &quot;GenomicFiles&quot;, &quot;simona&quot;, &quot;ComplexHeatmap&quot;)

# Getting strange behaviour from Seurat - going to try not installing azimuth
# pkg_devtools &lt;- c(&quot;sqjin/CellChat&quot;, &quot;chris-mcginnis-ucsf/DoubletFinder&quot;, 
#                   &quot;satijalab/azimuth&quot;)
pkg_devtools &lt;- c(&quot;jinworks/CellChat&quot;, &quot;rpolicastro/scProportionTest&quot;,
                  &quot;chris-mcginnis-ucsf/DoubletFinder&quot;, &quot;neurogenomics/scFlow&quot;,
                  &quot;immunogenomics/presto&quot;, &quot;cole-trapnell-lab/monocle3&quot;,
                  &quot;satijalab/seurat-wrappers&quot;)

#devtools::install_github(&quot;neurogenomics/scFlow&quot;)

## create function to installing any missing packages and then load them all
sort_packages &lt;- function(packages, bioconductor = FALSE, devtools = FALSE) {
    ## Check if packages are not installed and assign the
    ## names of the packages not installed to the variable new.pkg
    new_pkg &lt;- packages[!(packages %in% installed.packages())]
    ## If the packages are bioconductor, install via biocmanager
    ## If there are any packages in the list that aren't installed,
    ## install them
    if (length(new_pkg) &gt; 0 &amp; !bioconductor &amp; !devtools) {
        install.packages(new_pkg, repos = &quot;https://cran.rstudio.com&quot;)
    } else if (length(new_pkg) &gt; 0 &amp; bioconductor) {
        BiocManager::install(new_pkg)
    } else if (length(new_pkg) &gt; 0 &amp; devtools) {
      #devtools::install_github(new_pkg)
      remotes::install_github(new_pkg, upgrade = TRUE)
    }
    
    if (devtools) {
      packages &lt;- sapply(strsplit(packages, &quot;/&quot;), tail, n = 1)
    }
    ## load packages
    lapply(packages, require, character.only = TRUE)
}
## use function
sort_packages(pkg)
</code>
<boxed-text>
  <preformat>Loading required package: stringr</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: DT</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: reshape</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: dplyr</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'dplyr'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:reshape':

    rename</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:stats':

    filter, lag</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: tidyr</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'tidyr'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:reshape':

    expand, smiths</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: tibble</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: purrr</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: here</preformat>
</boxed-text>
<boxed-text>
  <preformat>here() starts at /mnt/b57480ca-5ec4-4912-b90b-3982312c5328/UK Dementia Research Institute Dropbox/Gabriel Bernardo Harrington/backup/research/blood-brain-barrier-in-ad</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: readr</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: kableExtra</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'kableExtra'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:dplyr':

    group_rows</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: janitor</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'janitor'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: labelled</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BiocManager</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: data.table</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'data.table'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:purrr':

    transpose</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:dplyr':

    between, first, last</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:reshape':

    melt</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: gt</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: europepmc</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: readxl</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: NMF</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: registry</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: rngtools</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: cluster</preformat>
</boxed-text>
<boxed-text>
  <preformat>NMF - BioConductor layer [OK] | Shared memory capabilities [NO: bigmemory] | Cores 2/2</preformat>
</boxed-text>
<boxed-text>
  <preformat>  To enable shared memory capabilities, try: install.extras('
NMF
')</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: furrr</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: future</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'future'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:NMF':

    run</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: future.apply</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: parallel</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: targets</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: forcats</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: downlit</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: xml2</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: corrgram</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: RColorBrewer</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: pheatmap</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggplot2</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggsci</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: cowplot</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'cowplot'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:gt':

    as_gtable</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:reshape':

    stamp</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scales</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'scales'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:readr':

    col_factor</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:purrr':

    discard</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggvenn</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: grid</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggpubr</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'ggpubr'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:cowplot':

    get_legend</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: gridExtra</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'gridExtra'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:Biobase':

    combine</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:BiocGenerics':

    combine</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:dplyr':

    combine</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: tidytext</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: viridis</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: viridisLite</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'viridis'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:scales':

    viridis_pal</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: wesanderson</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: pals</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'pals'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:viridis':

    cividis, inferno, magma, plasma, turbo, viridis</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:viridisLite':

    cividis, inferno, magma, plasma, turbo, viridis</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggalluvial</preformat>
</boxed-text>
<boxed-text>
  <preformat>$helpers1
[1] TRUE

$helpers2
[1] TRUE

$helpers3
[1] TRUE

$helpers4
[1] TRUE

$helpers5
[1] TRUE

$helpers6
[1] TRUE

$helpers7
[1] TRUE

$helpers8
[1] TRUE

$helpers9
[1] TRUE

$helpers10
[1] TRUE

$helpers11
[1] TRUE

$helpers12
[1] TRUE

$helpers13
[1] TRUE

$helpers14
[1] TRUE

$helpers15
[1] TRUE

$helpers16
[1] TRUE

$helpers17
[1] TRUE

$helpers18
[1] TRUE

$helpers19
[1] TRUE

$helpers20
[1] TRUE

$helpers21
[1] TRUE

$helpers22
[1] TRUE

$helpers23
[1] TRUE

$website1
[1] TRUE

$website2
[1] TRUE

$plots1
[1] TRUE

$plots2
[1] TRUE

$plots3
[1] TRUE

$plots4
[1] TRUE

$plots5
[1] TRUE

$plots6
[1] TRUE

$plots7
[1] TRUE

$plots8
[1] TRUE

$plots9
[1] TRUE

$plots10
[1] TRUE

$plots11
[1] TRUE

$plots12
[1] TRUE

$plots13
[1] TRUE

$plots14
[1] TRUE

$plots15
[1] TRUE</preformat>
</boxed-text>
<code language="r script">
sort_packages(pkg_bioconductor, bioconductor = TRUE)
</code>
<boxed-text>
  <preformat>Loading required package: cellity</preformat>
</boxed-text>
<boxed-text>
  <preformat></preformat>
</boxed-text>
<boxed-text>
  <preformat></preformat>
</boxed-text>
<boxed-text>
  <preformat>Registered S3 methods overwritten by 'proxy':
  method               from    
  print.registry_field registry
  print.registry_entry registry</preformat>
</boxed-text>
<boxed-text>
  <preformat></preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scater</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SingleCellExperiment</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SummarizedExperiment</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: MatrixGenerics</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: matrixStats</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'matrixStats'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:Biobase':

    anyMissing, rowMedians</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:dplyr':

    count</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'MatrixGenerics'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:Biobase':

    rowMedians</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: GenomicRanges</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: stats4</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: S4Vectors</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'S4Vectors'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:NMF':

    nrun</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:data.table':

    first, second</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:tidyr':

    expand</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:dplyr':

    first, rename</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:reshape':

    expand, rename</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:utils':

    findMatches</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:base':

    expand.grid, I, unname</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: IRanges</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'IRanges'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:data.table':

    shift</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:purrr':

    reduce</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:dplyr':

    collapse, desc, slice</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: GenomeInfoDb</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scuttle</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: Seurat</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SeuratObject</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: sp</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'sp'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:IRanges':

    %over%</preformat>
</boxed-text>
<boxed-text>
  <preformat>'SeuratObject' was built under R 4.4.0 but the current version is
4.4.1; it is recomended that you reinstall 'SeuratObject' as the ABI
for R may have changed</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'SeuratObject'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:SummarizedExperiment':

    Assays</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:GenomicRanges':

    intersect</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:GenomeInfoDb':

    intersect</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:IRanges':

    intersect</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:S4Vectors':

    intersect</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:BiocGenerics':

    intersect</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:DT':

    JS</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:base':

    intersect, t</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'Seurat'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:SummarizedExperiment':

    Assays</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:DT':

    JS</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SC3</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: DESeq2</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'DESeq2'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:scater':

    fpkm</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: edgeR</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: limma</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'limma'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:DESeq2':

    plotMA</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:scater':

    plotMDS</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:BiocGenerics':

    plotMA</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'edgeR'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:SingleCellExperiment':

    cpm</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BiocParallel</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'BiocParallel'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:NMF':

    register</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: org.Hs.eg.db</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: AnnotationDbi</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'AnnotationDbi'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:dplyr':

    select</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: pathview</preformat>
</boxed-text>
<boxed-text>
  <preformat>##############################################################################
Pathview is an open source software package distributed under GNU General
Public License version 3 (GPLv3). Details of GPLv3 is available at
http://www.gnu.org/licenses/gpl-3.0.html. Particullary, users are required to
formally cite the original Pathview paper (not just mention it) in publications
or products. For details, do citation(&quot;pathview&quot;) within R.

The pathview downloads and uses KEGG data. Non-academic uses may require a KEGG
license agreement (details at http://www.kegg.jp/kegg/legal.html).
##############################################################################</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: gage</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: gageData</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: DropletUtils</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ensembldb</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: GenomicFeatures</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: AnnotationFilter</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'AnnotationFilter'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:future':

    value</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'ensembldb'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:dplyr':

    filter</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:stats':

    filter</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: AnnotationHub</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BiocFileCache</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: dbplyr</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'dbplyr'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:dplyr':

    ident, sql</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'AnnotationHub'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:Biobase':

    cache</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: patchwork</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'patchwork'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:cowplot':

    align_plots</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scran</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: PCAtools</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ggrepel</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'PCAtools'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:scran':

    parallelPCA</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:stats':

    biplot, screeplot</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: batchelor</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: bluster</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: igraph</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'igraph'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:Seurat':

    components</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:scater':

    normalize</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:GenomicRanges':

    union</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:IRanges':

    union</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:S4Vectors':

    union</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:future':

    %-&gt;%, %&lt;-%</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:NMF':

    algorithm, compare</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:BiocGenerics':

    normalize, path, union</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:purrr':

    compose, simplify</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:tibble':

    as_data_frame</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:tidyr':

    crossing</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:dplyr':

    as_data_frame, groups, union</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:stats':

    decompose, spectrum</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:base':

    union</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scRNAseq</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: biomaRt</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'biomaRt'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:scRNAseq':

    listDatasets, searchDatasets</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: GEOquery</preformat>
</boxed-text>
<boxed-text>
  <preformat>Setting options('download.file.method.GEOquery'='auto')</preformat>
</boxed-text>
<boxed-text>
  <preformat>Setting options('GEOquery.inmemory.gpl'=FALSE)</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: clusterProfiler</preformat>
</boxed-text>
<boxed-text>
  <preformat>clusterProfiler v4.12.3 Learn more at https://yulab-smu.top/contribution-knowledge-mining/

Please cite:

Guangchuang Yu, Li-Gen Wang, Yanyan Han and Qing-Yu He.
clusterProfiler: an R package for comparing biological themes among
gene clusters. OMICS: A Journal of Integrative Biology. 2012,
16(5):284-287</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'clusterProfiler'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:biomaRt':

    select</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:igraph':

    simplify</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:ensembldb':

    filter, select</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:AnnotationDbi':

    select</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:IRanges':

    slice</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:S4Vectors':

    rename</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:purrr':

    simplify</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:reshape':

    rename</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:stats':

    filter</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: DOSE</preformat>
</boxed-text>
<boxed-text>
  <preformat>DOSE v3.30.2  For help: https://yulab-smu.top/biomedical-knowledge-mining-book/

If you use DOSE in published research, please cite:
Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics 2015, 31(4):608-609</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: enrichplot</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'enrichplot'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:ggpubr':

    color_palette</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: EnsDb.Hsapiens.v79</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: fgsea</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: MAST</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: speckle</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: rrvgo</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: MungeSumstats</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BSgenome.Hsapiens.1000genomes.hs37d5</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BSgenome</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: Biostrings</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: XVector</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'XVector'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:purrr':

    compact</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'Biostrings'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:pals':

    alphabet</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:grid':

    pattern</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:base':

    strsplit</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BiocIO</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: rtracklayer</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'rtracklayer'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:BiocIO':

    FileForFormat</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:igraph':

    blocks</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:AnnotationHub':

    hubUrl</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: BSgenome.Hsapiens.NCBI.GRCh38</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SNPlocs.Hsapiens.dbSNP155.GRCh37</preformat>
</boxed-text>
<boxed-text>
  <preformat>Warning: replacing previous import 'utils::findMatches' by
'S4Vectors::findMatches' when loading 'SNPlocs.Hsapiens.dbSNP155.GRCh37'</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: qusage</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'qusage'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:clusterProfiler':

    read.gmt</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: SNPlocs.Hsapiens.dbSNP155.GRCh38</preformat>
</boxed-text>
<boxed-text>
  <preformat>Warning: replacing previous import 'utils::findMatches' by
'S4Vectors::findMatches' when loading 'SNPlocs.Hsapiens.dbSNP155.GRCh38'</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'SNPlocs.Hsapiens.dbSNP155.GRCh38'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:SNPlocs.Hsapiens.dbSNP155.GRCh37':

    .loadAlleles, .loadLoc, COMPATIBLE_BSGENOMES</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: GenomicFiles</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: Rsamtools</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'GenomicFiles'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:tidyr':

    pack, unpack</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: simona</preformat>
</boxed-text>
<boxed-text>
  <preformat>========================================
simona version 1.2.0
Bioconductor page: http://bioconductor.org/packages/simona/
Github page: https://github.com/jokergoo/simona
Documentation: https://jokergoo.github.io/simona/

If you use it in published research, please cite:
Gu, Z. simona: a Comprehensive R package for Semantic Similarity 
  Analysis on Bio-Ontologies. bioRxiv 2023.

This message can be suppressed by:
  suppressPackageStartupMessages(library(simona))
========================================</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: ComplexHeatmap</preformat>
</boxed-text>
<boxed-text>
  <preformat>========================================
ComplexHeatmap version 2.20.0
Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/
Github page: https://github.com/jokergoo/ComplexHeatmap
Documentation: http://jokergoo.github.io/ComplexHeatmap-reference

If you use it in published research, please cite either one:
- Gu, Z. Complex Heatmap Visualization. iMeta 2022.
- Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional 
    genomic data. Bioinformatics 2016.


The new InteractiveComplexHeatmap package can directly export static 
complex heatmaps into an interactive Shiny app with zero effort. Have a try!

This message can be suppressed by:
  suppressPackageStartupMessages(library(ComplexHeatmap))
========================================
! pheatmap() has been masked by ComplexHeatmap::pheatmap(). Most of the arguments
   in the original pheatmap() are identically supported in the new function. You 
   can still use the original function by explicitly calling pheatmap::pheatmap().</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'ComplexHeatmap'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:pheatmap':

    pheatmap</preformat>
</boxed-text>
<boxed-text>
  <preformat>[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

[[4]]
[1] TRUE

[[5]]
[1] TRUE

[[6]]
[1] TRUE

[[7]]
[1] TRUE

[[8]]
[1] TRUE

[[9]]
[1] TRUE

[[10]]
[1] TRUE

[[11]]
[1] TRUE

[[12]]
[1] TRUE

[[13]]
[1] TRUE

[[14]]
[1] TRUE

[[15]]
[1] TRUE

[[16]]
[1] TRUE

[[17]]
[1] TRUE

[[18]]
[1] TRUE

[[19]]
[1] TRUE

[[20]]
[1] TRUE

[[21]]
[1] TRUE

[[22]]
[1] TRUE

[[23]]
[1] TRUE

[[24]]
[1] TRUE

[[25]]
[1] TRUE

[[26]]
[1] TRUE

[[27]]
[1] TRUE

[[28]]
[1] TRUE

[[29]]
[1] TRUE

[[30]]
[1] TRUE

[[31]]
[1] TRUE

[[32]]
[1] TRUE

[[33]]
[1] TRUE

[[34]]
[1] TRUE

[[35]]
[1] TRUE

[[36]]
[1] TRUE

[[37]]
[1] TRUE

[[38]]
[1] TRUE

[[39]]
[1] TRUE

[[40]]
[1] TRUE

[[41]]
[1] TRUE

[[42]]
[1] TRUE

[[43]]
[1] TRUE</preformat>
</boxed-text>
<code language="r script">
sort_packages(pkg_devtools, devtools = TRUE)
</code>
<boxed-text>
  <preformat>Skipping install of 'CellChat' from a github remote, the SHA1 (b05405af) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'scProportionTest' from a github remote, the SHA1 (37a04900) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'DoubletFinder' from a github remote, the SHA1 (03e9f37f) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'scFlow' from a github remote, the SHA1 (065bc13d) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'presto' from a github remote, the SHA1 (7636b3d0) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'monocle3' from a github remote, the SHA1 (98402ed0) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Skipping install of 'SeuratWrappers' from a github remote, the SHA1 (8d46d6c4) has not changed since last install.
  Use `force = TRUE` to force installation</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: CellChat</preformat>
</boxed-text>
<boxed-text>
  <preformat>Registered S3 method overwritten by 'ggnetwork':
  method         from  
  fortify.igraph ggtree</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'CellChat'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:scater':

    runPCA, runUMAP</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scProportionTest</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: DoubletFinder</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: scFlow</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: presto</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: Rcpp</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: monocle3</preformat>
</boxed-text>
<boxed-text>
  <preformat>
Attaching package: 'monocle3'</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:presto':

    top_markers</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following object is masked from 'package:igraph':

    clusters</preformat>
</boxed-text>
<boxed-text>
  <preformat>The following objects are masked from 'package:Biobase':

    exprs, fData, fData&lt;-, pData, pData&lt;-</preformat>
</boxed-text>
<boxed-text>
  <preformat>Loading required package: seurat-wrappers</preformat>
</boxed-text>
<boxed-text>
  <preformat>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'seurat-wrappers'</preformat>
</boxed-text>
<boxed-text>
  <preformat>[[1]]
[1] TRUE

[[2]]
[1] TRUE

[[3]]
[1] TRUE

[[4]]
[1] TRUE

[[5]]
[1] TRUE

[[6]]
[1] TRUE

[[7]]
[1] FALSE</preformat>
</boxed-text>
</sec>
<sec specific-use="notebook-content">
<code language="r script"># subset devtools packages to after the &quot;/&quot; for the library calls
pkg_devtools &lt;- sapply(strsplit(pkg_devtools, &quot;/&quot;), tail, n = 1)
pkg_devtools &lt;- sub(&quot;azimuth&quot;, &quot;Azimuth&quot;, pkg_devtools)
pkg_devtools &lt;- sub(&quot;seurat-wrappers&quot;, &quot;SeuratWrappers&quot;, pkg_devtools)

# create library calls for renv
library_calls &lt;- paste0(&quot;library(&quot;, c(pkg, pkg_bioconductor, pkg_devtools), &quot;)&quot;)
write_lines(library_calls, here(&quot;04_data_analysis/990_code_libraries/02_library-calls-for-renv.R&quot;))
</code>
</sec>
<sec specific-use="notebook-content">
<code language="r script">rm(pkg, pkg_bioconductor, pkg_devtools, sort_packages)
</code>
</sec>
</body>



<back>
</back>


</sub-article>