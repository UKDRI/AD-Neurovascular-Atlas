---
title: Run scflow
# execute: 
#   eval: false
bibliography: references.bib
---

# Custom config file

There is a SCW config file for nf-core with some nice [documentation](https://github.com/nf-core/configs/blob/master/docs/scw.md), so we'll use that.
Note that by default the scw config uses the htc queue and we'd rather use our DRI nodes, so I'll overwrite that.

We can also use a config file with the parameters we want to use with scflow.

Note that after I purl this config I'll manually update the Nextflow Tower token on hawk.

```{r}
#| purl: true
executor { 
  name = 'slurm' 
  queueSize = 10
  queue = 'c_vhighmem_dri1'
}

params {
  max_memory = 700.GB
  max_cpus = 30
  max_time = 82.h
}

tower {
  accessToken = keyring::key_get("hawk_nextflow_tower")
  enabled = true
}
process {
    clusterOptions = '--account=scw1329'
}
```

Note that I'm using the `dev-nf` branch to run.

```{r}
#| eval: false
#| purl: false
nextflow run combiz-nf-core-scflow-dev-nf/workflow/ -profile scw -c 03_data/990_processed_data/001_snrnaseq/06_scflow/pipeline.config --manifest 03_data/990_processed_data/001_snrnaseq/06_scflow/scflow_manifest_both.tsv --input 03_data/990_processed_data/001_snrnaseq/90_sample_info/sample_metadata.tsv --reddim_genes_yml reddim_genes.yml -resume -bg > 03_data/990_processed_data/001_snrnaseq/06_scflow/scflow.log
```